variables:
- name: ca
  type: certificate
  options:
    is_ca: true

- name: server
  type: certificate
  options:
    ca: ca
    common_name: default.nats
    alternative_names:
    - localhost
    - "127.0.0.1"
    extended_key_usage:
    - server_auth

- name: valid_client
  type: certificate
  options:
    ca: ca
    common_name: default.client_1
    alternative_names:
    - localhost
    - "127.0.0.1"
    extended_key_usage:
    - client_auth

- name: no_common_name
  type: certificate
  options:
    ca: ca
    alternative_names:
    - localhost
    - "127.0.0.1"
    extended_key_usage:
    - client_auth

- name: client_id_only
  type: certificate
  options:
    ca: ca
    alternative_names:
    - localhost
    - "127.0.0.1"
    common_name: default
    extended_key_usage:
    - client_auth

- name: non_existent_client
  type: certificate
  options:
    ca: ca
    alternative_names:
    - localhost
    - "127.0.0.1"
    common_name: default.non_existent_client
    extended_key_usage:
    - client_auth

- name: wildcard_star_clientid
  type: certificate
  options:
    ca: ca
    alternative_names:
    - localhost
    - "127.0.0.1"
    common_name: "*.client_1"
    extended_key_usage:
    - client_auth

- name: wildcard_greater_client
  type: certificate
  options:
    ca: ca
    alternative_names:
    - localhost
    - "127.0.0.1"
    common_name: ">.client_1"
    extended_key_usage:
    - client_auth

- name: valid_client_name_client_id
  type: certificate
  options:
    ca: ca
    common_name: client_id.client_name
    extended_key_usage:
    - client_auth

- name: invalid_client_no_common_name
  type: certificate
  options:
    ca: ca
    common_name: ""
    extended_key_usage:
    - client_auth

- name: invalid_client_name_no_dots
  type: certificate
  options:
    ca: ca
    common_name: client_name
    extended_key_usage:
    - client_auth

- name: client_name_one_dot
  type: certificate
  options:
    ca: ca
    common_name: .client_name
    extended_key_usage:
    - client_auth

- name: client_name_multi_dots
  type: certificate
  options:
    ca: ca
    common_name: client_id.client_name_part1.client_name_part2
    extended_key_usage:
    - client_auth

- name: client_name_multi_consecutive_dots
  type: certificate
  options:
    ca: ca
    common_name: ..client_name
    extended_key_usage:
    - client_auth